<Window x:Class="WpMyApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WPF Data Management App" Height="700" Width="1200">

    <Window.Resources>
        <!-- Конвертер для видимости -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- Стили для статусов -->
        <Style x:Key="StatusIndicator" TargetType="Border">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Status.CurrentStatus}" Value="Loading">
                    <Setter Property="Background" Value="LightBlue"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status.CurrentStatus}" Value="Saving">
                    <Setter Property="Background" Value="LightGreen"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status.CurrentStatus}" Value="Deleting">
                    <Setter Property="Background" Value="LightCoral"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status.CurrentStatus}" Value="Error">
                    <Setter Property="Background" Value="LightPink"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status.CurrentStatus}" Value="Success">
                    <Setter Property="Background" Value="LightGreen"/>
                </DataTrigger>
            </Style.Triggers>
            <Setter Property="Background" Value="LightGray"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="Padding" Value="5,2"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Status -->
        <GroupBox Grid.Row="0" Header="Application Status" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Border Style="{StaticResource StatusIndicator}" Margin="0,0,10,0">
                    <TextBlock Text="{Binding Status.CurrentStatus}" FontWeight="Bold" Margin="5,0"/>
                </Border>
                <TextBlock Text="{Binding Status.Message}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <ProgressBar Width="100" Height="10" Margin="10,0,0,0" 
                           IsIndeterminate="{Binding Status.IsBusy}" 
                           Visibility="{Binding Status.IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </StackPanel>
        </GroupBox>

        <!-- Main Content -->
        <TabControl Grid.Row="1">
            <!-- Users Tab -->
            <TabItem Header="Users Management">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- User Form -->
                    <GroupBox Grid.Row="0" Header="User Form" Margin="0,0,0,10" IsEnabled="{Binding IsUserFormEnabled}">
                        <StackPanel Orientation="Horizontal">
                            <StackPanel Width="120" Margin="0,0,10,0">
                                <TextBlock Text="First Name *" Margin="0,0,0,5"/>
                                <TextBox Text="{Binding SelectedUser.FirstName, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>

                            <StackPanel Width="120" Margin="0,0,10,0">
                                <TextBlock Text="Last Name *" Margin="0,0,0,5"/>
                                <TextBox Text="{Binding SelectedUser.LastName, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>

                            <StackPanel Width="150" Margin="0,0,10,0">
                                <TextBlock Text="Email" Margin="0,0,0,5"/>
                                <TextBox Text="{Binding SelectedUser.Email, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>

                            <StackPanel VerticalAlignment="Bottom">
                                <Button Content="New" Command="{Binding NewUserCommand}" Width="60" Margin="0,0,5,0"/>
                                <Button Content="Save" Command="{Binding SaveUserCommand}" Width="60" Margin="0,0,5,0" Background="LightGreen"/>
                                <Button Content="Delete" Command="{Binding DeleteUserCommand}" Width="60" Background="LightCoral"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Users List with Search -->
                    <GroupBox Grid.Row="1" Header="Users List">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Search Panel -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBox Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}" 
                                         Width="200" Margin="0,0,10,0"/>
                                <Button Content="Search" Command="{Binding SearchUsersCommand}" Width="60" Margin="0,0,5,0"/>
                                <Button Content="Clear" Command="{Binding ClearSearchCommand}" Width="60" Margin="0,0,10,0"/>
                                <TextBlock Text="{Binding TotalUsers, StringFormat='Total Users: {0}'}" 
                                           VerticalAlignment="Center" FontWeight="Bold"/>
                            </StackPanel>

                            <!-- Users Grid -->
                            <DataGrid Grid.Row="1" ItemsSource="{Binding Users}" 
                                      SelectedItem="{Binding SelectedUser}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="First Name" Binding="{Binding FirstName}" Width="100"/>
                                    <DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" Width="100"/>
                                    <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="150"/>
                                    <DataGridTextColumn Header="Age" Binding="{Binding Age}" Width="60"/>
                                    <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Products Tab -->
            <TabItem Header="Products Management">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Products List -->
                    <GroupBox Grid.Row="1" Header="Products List">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="Load Products" Command="{Binding LoadProductsCommand}" Width="100"/>
                                <TextBlock Text="{Binding TotalProducts, StringFormat='Total Products: {0}'}" 
                                           VerticalAlignment="Center" FontWeight="Bold" Margin="10,0,0,0"/>
                            </StackPanel>

                            <DataGrid Grid.Row="1" ItemsSource="{Binding Products}" 
                                      SelectedItem="{Binding SelectedProduct}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                                    <DataGridTextColumn Header="Price" Binding="{Binding Price}" Width="80"/>
                                    <DataGridTextColumn Header="Stock" Binding="{Binding StockQuantity}" Width="60"/>
                                    <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer - альтернативная версия -->
        <Grid Grid.Row="2" Margin="0,10,0,0" Background="LightGray" Height="25">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="{Binding Status.Message}" 
                      VerticalAlignment="Center" Margin="5,0"/>
            <TextBlock Grid.Column="1" Text="{Binding TotalUsers, StringFormat='Users: {0}'}" 
                      VerticalAlignment="Center" Margin="10,0"/>
            <TextBlock Grid.Column="2" Text="{Binding TotalProducts, StringFormat='Products: {0}'}" 
                      VerticalAlignment="Center" Margin="10,0,5,0"/>
        </Grid>
    </Grid>
</Window>